# 订单号组件
随着互联网的发展，电商平台已经日渐成熟，国民逐步由线下实体购物转战到线上购物。随之而来的是各大电商平台的订单量与日俱增，所以各种订单号的维护就成为业务部门急需解决的大问题。
一个订单号怎么才能尽可能的简短，但又包罗各种定位信息。比如说：订单号 = 业务号 + 地区号 + 时间 + 用户ID + 有序数字，这样的订单号定位性很强：
- 时间：可以定位到这个订单是否在质保期内
- 业务号：可以定位到这个订单是哪个产品线的订单
- 地区号：可以定位到这个订单最终的配送方向，可以选择就近的仓库出货
- 用户ID：可以快速锁定订单和当前用户的关系，订单纠纷可用
- 有序数字 + 用户ID：可以控制并发场景下订单号的唯一性
## 订单号的特点
我们设计订单号的时候应该尽可能为后续的维护多做考虑。比如：把订单号设置成一个
- 数值类型：常见关系型数据库的存储引擎支持整型类型的索引非常友好，相对字符串，有天然的优势
- 固定长度：便于查询，订单号的作用就是便于查询。一般正常使用场景应该是订单出现异状时候，用户将订单号报给客服，由客服进行查询
- 全局唯一：确保订单不会重复，一般是用来作为主键
- 趋势递增：为了适应微服务下订单号的全局唯一，不是固定递增，避免竞争对手根据订单号分析出销售量
- 安全性：电商平台是一个高并发的应用场景，而保证高并发即是在保证订单号生成器组件的高可用，常见措施有：Cluster、双机热备、LoadBalance等等
## 订单号的加/解密
一般来说电商平台给到用户的订单都可能是很简短的一串数字，比如：京东12位数字，淘宝的18位数字。其实在这么短的数字里面不可能包含太多的定位信息，所以这些简短的订单号一般都是经过加密压缩后的。它的目的是为了用户和客服能方便的记住订单号，以及后续的售后处理流程。
### 加密
加密就相当于是给一串比较长的订单号进行压缩，得到一串更加简短的订单号。
### 解密
加密就相当于是把一串加密过的简短订单号进行解压，还原得到一串更长的订单号。
### 加/解密算法
这是订单号长短映射的关键所在，算法的选择也是极为关键。既要可以有效压缩数值长度，还可以随时可逆恢复原始长度数值。
## 订单号设计规则
### 定位元素
- 业务号：产品线（京东药房、京东生鲜、京东商场。。。）
- 地区号：订单配送所在地的编号
- 时间：提交订单时刻的时间戳
- 用户ID：下单用户在电商平台的ID号
- 有序数字：单调递增的数字
### 元素长度
- 业务号：2位数字
- 地区号：3位数字
- 时间：13位数字
- 用户ID：4位数字
- 有序数字：2位数字
### 元素生产规则
### 元素拼接规则
订单号 = 业务号 + 地区号 + 时间 + 用户ID + 有序数字
